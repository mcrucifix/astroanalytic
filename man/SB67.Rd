% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SB67.R
\name{SB67}
\alias{SB67}
\title{Sharaf-Budnikova model, based on Berger's implementation}
\usage{
SB67(
  PlanetarySolution,
  P0 = 17.3919 * pi/(3600 * 180),
  ell = 54.9066 * pi/(3600 * 180),
  epsilonbar = 23.399935 * pi/180,
  zeta = 1.600753 * pi/180,
  aggregating = TRUE,
  ber78_strict = FALSE,
  ber90_reproduce = FALSE
)
}
\arguments{
\item{PlanetarySolution}{list containing the planetary solution:
- `epi`: trigonometric series of eccentricity and perihelion (h,k,q,p)
- `i2o` or `io`: trigonometric series for inclination (i/2) and node (ω)}

\item{P0}{numeric, partial derivative of precession with respect to eccentricity, in radians}

\item{ell}{numeric, "newcomb" constant, in radians}

\item{epsilonbar}{numeric, mean obliquity at reference year, in radians}

\item{zeta}{numeric, precession phase at reference year, in radians. Warning: phase reference differs between Laskar (2000) and Bretagnon (1950)}

\item{aggregating}{logical, should terms with the same frequency be aggregated? Default is `TRUE`.}

\item{ber78_strict}{logical, enforce original implementation of Berger (1973) thesis. Default `FALSE`.}

\item{ber90_reproduce}{logical, hack to reproduce Berger and Loutre (1991) results exactly. Default `FALSE`.}
}
\value{
A list with three `discreteSpectrum` objects:
  - `OBLIQUITY`: amplitudes, angular frequencies, and phases for obliquity.
  - `PSI`: amplitudes, angular frequencies, and phases for longitude of vernal equinox on fixed plane.
  - `CLIMPRECESS`: amplitudes, angular frequencies, and phases for climatic precession.
  Each `discreteSpectrum` has attributes:
  - `shift`: phase reference relative to zero
  - `trend`: for PSI, the mean trend
}
\description{
This is an R-recoding of André Berger's implementation of the Sharaf and Budnikova precession
model. Using, as inputs, a trigonometric expansion of (e, π) and (i/2, ω) (e.g., `data(La88)`),
newcomb constants (e.g., supplied by `newcomp_parameters`), mean obliquity, and mean precession
phase at the reference year corresponding to the orbital solution (usually 1950.0 or 2000.0),
this function supplies trigonometric expansions for obliquity (OBLIQUITY), longitude of the
vernal equinox with respect to the fixed plane (PSI), and climatic precession (CLIMPRECESS).
}
\note{
This code is an R-implementation of code developed by André Berger for his
thesis (Berger, 1973, UCLouvain), further developed until the publication
of Berger and Loutre (1991). The original Fortran subprograms (p7505ff.f and p75133f.f)
were not officially released. This R implementation has been validated against
Berger's code.

The code takes a trigonometric development of the planetary solution
(typically the h,k,q,p development of Bretagnon or Laskar) and, using the
precession equation to third order in masses and eccentricity,
generates trigonometric developments for climatic precession and obliquity.
Amplitudes are dimensionless, scaled appropriately for consistency.

Running this routine typically takes about one second on a modern computer. The
resulting precession and obliquity series can be evaluated efficiently for any
time period where the supplied parameters are valid. Given the nature of orbital
solutions and the range of validity of the SB development (accurate to order 2
in eccentricity), results are generally reliable up to ~2–3 million years.

\strong{Validation:} The match with Berger's original routines is perfect down
to 1.e-14 for two points in a time series, so aggregation works well.
}
\examples{
require(gtseries)
data(La88)
# Aggregated series
S <- SB67(La88, aggregating = TRUE)
# Ungrouped series
S2 <- SB67(La88, aggregating = FALSE)

# Example reconstruction of PSI
psi1 <- develop(S$PSI, -1e6, 0, 1e3)
psi2 <- develop(S2$PSI, -1e6, 0, 1e3)
plot(psi1)
lines(psi1 - psi2)

}
\references{
Berger, A. L., & Loutre, M. F. (1991). Insolation values for the climate of the last 10 million years.
\emph{Quaternary Science Reviews}, 10(4), 297–317. \doi{10.1016/0277-3791(91)90033-Q}

Sharaf, S. G., & Budnikova, N. A. (1967). Secular variations of elements of the Earth's orbit which
influence the climates of the geological past. \emph{Trudy Instituta Teoreticheskoi Astronomii},
11, 231–261. [in Russian]

Berger, A. L. (1973). Théorie astronomique des paléoclimats, PhD thesis, Université Catholique de Louvain,
https://hdl.handle.net/2078.1/233872
}
